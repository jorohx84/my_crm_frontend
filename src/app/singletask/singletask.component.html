<section>

    <div class="taskHeader">
        <div class="taskTitle">
            <input [disabled]="!globalservice.checkPermissions(user, task, 'reviewer')" (change)="changeTitle('title')"
                class="title" [(ngModel)]="task.title" type="text">
            <div *ngIf="task?.state==='closed'" class="closeText">
                <h1>Abgschlossen</h1>
                <img src="./icons/done.svg" alt="">

            </div>

        </div>


        <div class="taskMenu">
            <button *ngIf="task?.reviewer?.id===user?.id && task?.state==='done'"
                (click)="releaseTask()">Freigeben</button>

            <button *ngIf="task?.assignee?.id===user?.id && task?.state==='released'"
                (click)="closeTask()">Abschließen</button>
            <button (click)="openMemberlist()">Mitarbeiter hinzufügen</button>
            <button (click)="globalservice.navigateToPath(['main', 'board'])">Board öffnen</button>
            <button (click)="saveTaskTemplate()">Als Vorlage speichern</button>

            <div class="closeBtn">
                <img src="./icons/back.svg" alt="" (click)="backToCustomer()">

            </div>
        </div>

    </div>
    <div class="taskContent">


        <div class="taskInfoCont">
            <app-taskinfobar *ngIf="isloaded" [task]="task" (infosChanged)="onTaskChanged($event)"></app-taskinfobar>
            <div class="memberList">
                <div *ngFor="let member of task.members, let index=index">
                    <div class="memberDot" [style.background-color]="member.profile.color">
                        <p>{{member?.profile?.initials}}</p>
                    </div>

                </div>
            </div>


            <div class="taskInfoSubCont">

                <div class="description">
                    <div class="subheadline">
                        <h4>Beschreibung</h4>
                    </div>


                    <textarea (change)="updateTask({description:task.description},'description')" name="" id=""
                        [(ngModel)]="task.description"></textarea>
                </div>
                <div class="subtaskCont">
                    <app-subtasks *ngIf="isloaded" [task]="task"
                        (subtaskChanged)="onTaskChanged($event)"></app-subtasks>
                </div>

            </div>

        </div>
        <div class="sidebarCont">
            <app-tasksidebar></app-tasksidebar>
        </div>

    </div>


    <div class="memberListWrapper  slideOut borderLeft" [ngClass]="{'slideIn': memberListOpen}">
        <app-memberlist [many]="true"></app-memberlist>
    </div>

</section>