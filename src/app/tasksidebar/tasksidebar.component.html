<div class="taskSidebar">
    <!-- <div class="sidabarNav">

        <div [ngClass]="{'btnHlgt': sidebarKey==='comments'}" (click)="changeSidebarContent('comments')">
            <h4>Chat</h4>
        </div>
        <div [ngClass]="{'btnHlgt': sidebarKey==='logs'}" (click)="changeSidebarContent('logs')">
            <h4>Historie</h4>
        </div>

    </div> -->
    <!-- <div class="placeholder"></div> -->
    <div class="addCont">
        <h4 *ngIf="!textfieldOpen">Nachrichten</h4>
        <h4 *ngIf="textfieldOpen">Neue Nachricht</h4>
        <img *ngIf="permission.isMember(task.members)" [ngClass]="{'rotate': textfieldOpen}" src="./icons/add.svg"
            alt="" (click)="toogleTextField()">

    </div>


    <div *ngIf="sidebarKey==='comments'" class="commentCont" [ngClass]="{'showTextfield': textfieldOpen}">

        <textarea #commentInput="ngModel" [(ngModel)]="comment.text" name="comment" placeholder="Schreibe ein Nachricht"
            id=""></textarea>
        <img *ngIf="comment.text!==''" (click)="createComment()" src="./icons/send.svg" alt="">
    </div>

    <div *ngIf="sidebarKey==='comments'" class="sidebarList">
        <h4 *ngIf="sortedComments.length===0">- Keine Nachrichten -</h4>
        <div class="" *ngFor="let comment of sortedComments, let index=index">
            <div class="commentsRow">
                <div class="commentInfo" [ngClass]="{'reverse': user.id===comment.creator.id}">
                    <div class="profileCont" [ngClass]="{'reverse': user.id===comment.creator.id}">
                        <div class="memberDot" [style.backgroundColor]="comment.creator.profile.color">
                            {{comment.creator.profile.initials}}</div>
                        <h4>{{comment?.creator?.profile?.fullname}}</h4>
                    </div>

                    <p *ngIf="global.isToday(comment.created_at)">
                        {{ comment.created_at | date:'HH:mm' }} Uhr
                    </p>

                    <!-- Innerhalb der letzten 7 Tage, aber nicht heute -->
                    <p *ngIf="!global.isToday(comment.created_at) && global.isLastWeek(comment.created_at)">
                        {{ comment.created_at | date:'EEEE' }}
                    </p>

                    <!-- Ã„lter als 7 Tage -->
                    <p *ngIf="!global.isLastWeek(comment.created_at)">
                        {{ comment.created_at | date:'dd.MM.yyyy' }}
                    </p>



                    <ng-template #showDate>{{comment.created_at | date: 'dd.MM.yy'}}</ng-template>
                    <!-- <img (click)="deleteComment(index)" *ngIf="comment.creator.id===user.id" src="./icons/trash.svg"
                        alt=""> -->
                </div>
                <!-- <div class="divider"></div> -->
                <textarea (change)="updateComment(index)" name="" [(ngModel)]="comment.text" id=""
                    [disabled]="comment.creator.id !== user.id "></textarea>
                <!-- <div class="bottemLine">

                </div> -->

            </div>
        </div>

    </div>



    <div *ngIf="sidebarKey==='logs'" class="sidebarList">

        <div *ngFor="let log of logBook">
            <div class="logCard">
                <p>{{log.logged_at | date: 'dd.MM.yyyy : HH:mm'}} Uhr</p>
                <div class="divider"></div>
                <h4>{{log.log}}</h4>
                <p *ngIf="log.type!=='due_date'">{{log.new_state}}</p>
                <p *ngIf="log.type==='due_date'">{{log.new_state | date: 'dd.MM.yyyy : HH:mm'}} Uhr</p>
                <p *ngIf="log.subtask">{{log.subtask}}</p>
                <p class="logAssignee">Bearbeiter: {{log.updated_by.profile.fullname}}</p>
            </div>
        </div>
    </div>

</div>